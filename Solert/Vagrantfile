# -*- mode: ruby -*-
# vi: set ft=ruby :

# All Vagrant configuration is done below. The "2" in Vagrant.configure
# configures the configuration version (we support older styles for
# backwards compatibility). Please don't change it unless you know what
# you're doing.
Vagrant.configure(2) do |config|
#  config.vm.box = "ubuntu/xenial64"
  config.vm.box = "ubuntu/trusty64"

  config.vm.synced_folder ".", "/vagrant", disabled: false

  config.vm.define "vm1" do |vm1|
    vm1.vm.network "private_network", ip: "192.168.10.14"
    vm1.vm.network "forwarded_port", guest: 9000, host: 9000

    # install docker and pull ubuntu image  
    config.vm1.provision "docker" do |d|
      d.build_image "/vagrant/docker/hello-scala",
        args: "-t image"

      d.run "image",
        args: "-p 9000:9000"
    end
  end

  config.vm.define "vm2" do |vm2|
    vm2.vm.network "private_network", ip: "192.168.10.15"
    vm2.vm.network "forwarded_port", guest: 80, host: 9001

    # install docker and pull ubuntu image  
    config.vm2.provision "docker" do |d|
      d.pull_images "hello-world"

      d.run "hello-world"
    end
  end
  
  config.vm.provider "virtualbox" do |v|
    v.memory = 1536
  end
  
  config.vm.provision "docker" do |d|
  end

  # install weave
  #config.vm.provision "shell", inline: <<-SHELL
  #  sudo curl -L git.io/weave -o /usr/local/bin/weave
  #  sudo chmod +x /usr/local/bin/weave
  #  weave launch
  #SHELL
end
